function sameDomain(c){var b=location.href,a=b.substring(0,b.indexOf(location.pathname));try{c=c.document;return c&&c.URL&&c.URL.indexOf(a)==0}catch(d){return false}}document.createElement("hgroup");document.createElement("header");document.createElement("nav");document.createElement("section");document.createElement("article");document.createElement("aside");document.createElement("footer");var loading="<img src='img/ajax-loader.gif' alt='loading...'>";var requestCache=new Array();function ajaxRequest(h,c,f,g,b){var d={cache:false,cacheTime:3600000,load:null,script:false,setvalue:false,callback:null,callback_params:null};$extend(d,b);g=$type(g)=="element"?g:$chk($(g))?$(g):null;if(d.cache&&$defined(requestCache[c+f])&&($time()-requestCache[c+f][0]<d.cacheTime)){if(d.setvalue){g.value=requestCache[c+f][1]}else{g.set("html",requestCache[c+f][1])}if(d.callback&&d.callback_params){d.callback(d.callback_params)}else{if($chk(d.callback)){d.callback()}}return true}var a=$chk(d.load)?($type(d.load)=="element"?d.load:$(d.load)):null;var e=new Request.HTML({evalScripts:d.script,url:c,method:h,data:f,onRequest:function(){if(a){a.set("html",loading)}},onComplete:function(l,i,m,j){if(a){a.set("html","")}rexp=/request error:(.*)/;var k=rexp.exec(m);if($chk(k)){alert(k[1])}else{if(d.setvalue&&g){g.setProperty("value",m)}else{if(g){g.set("html",m)}}if(d.cache){requestCache[c+f]=new Array($time(),m)}if(d.callback&&d.callback_params){d.callback(d.callback_params)}else{if($chk(d.callback)){d.callback()}}parseFunctions()}}}).send()}function confirmSubmit(c){var b=$chk(c)?c:"Are you sure you wish to continue?";var a=confirm(b);return a?true:false}function validateForm(e){$$("div[class=formErrMsg]").dispose();$$("label[class=req2]").setProperty("class","req");var h=e.getProperty("name");var n=true;var f=$$("#"+e.getProperty("id")+" label:not([class^=diji])");for(var d=0;d<f.length;d++){var o=false;var j=f[d];var l=j.getProperty("for");var c=/(.*?)\[\]/.exec(l);var b=(c&&c.length>0)?$$("#"+e.getProperty("id")+" [name^="+c[1]+"[]"):$$("#"+e.getProperty("id")+" [name="+l+"]");var a=b[0];if(j.hasClass("req")&&(!$chk(a.getParents("td[class=formCell]")[0])||(a.getParents("td[class=formCell]")[0].style.display!="none"))){if(typeof CKEDITOR!="undefined"&&typeof CKEDITOR.instances[l]!="undefined"){if(!$chk(CKEDITOR.instances[l].getData())){o=true}}else{if(a.type=="text"||a.type=="password"||a.match("textarea")||a.match("select")||a.type=="hidden"){if(!$chk(a.value)){o=true}}else{if(a.type=="radio"||a.type=="checkbox"){var k=false;for(var m=0;m<b.length;m++){if(b[m].checked){k=true;break}}if(!k){o=true}}}}}if(o){divMsg=new Element("div",{"class":"formErrMsg"});divMsg.set("html","campo obbligatorio");divMsg.inject(a,"before");j.className="req2";n=false}if(a.type=="text"){var g=a.getProperty("pattern")?a.getProperty("pattern"):null;if($chk(a.value)){if((g&&!new RegExp(g).test(a.value))){divMsg=new Element("div",{"class":"formErrMsg"});divMsg.set("html",a.getProperty("placeholder"));divMsg.inject(a,"before");j.className="req2";n=false}}}}if(!n){alert("Errore nella compilazione del form")}return n}function prepareTrlForm(m,e,i,n,l,f,d,c,a){var o=false;var k=e.getParent();if($("trnsl_container")){if(k==$("trnsl_container").getPrevious("div")&&e.hasClass("trnsl_lng_sel")){o=true}var j=$("trnsl_container").getPrevious();j.getChildren("span").removeClass("trnsl_lng_sel");$("trnsl_container").dispose();CKEDITOR.remove(CKEDITOR.instances["trnsl_"+n])}var g=new Element("div",{id:"trnsl_container","class":"form_translation"});k.getChildren("span").removeClass("trnsl_lng_sel");if(!o){e.addClass("trnsl_lng_sel");g.inject(k,"after");var b=a+"?pt[language-formTranslation]";var h="lng_code="+m+"&tbl="+i+"&field="+n+"&type="+l+"&id_value="+f+"&width="+d+"&fck_toolbar="+c;ajaxRequest("post",b,h,g,{load:i+n,cache:true,cacheTime:5000,callback:function(){var p=a+"?pt[language-replaceTextarea]";ajaxRequest("post",p,"fck_toolbar="+c+"&width="+d+"&field="+n+"&type="+l,null,{script:true})}})}}var DatePicker=new Class({Implements:Options,d:"",today:"",choice:{},bodysize:{},limit:{},attachTo:null,picker:null,slider:null,oldContents:null,newContents:null,input:null,visual:null,options:{pickerClass:"datepicker",days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayShort:2,monthShort:3,startDay:1,timePicker:false,timePickerOnly:false,yearPicker:true,yearsPerPage:20,format:"d-m-Y",allowEmpty:false,inputOutputFormat:"U",animationDuration:400,useFadeInOut:!Browser.ie,startView:"month",positionOffset:{x:0,y:0},minDate:null,maxDate:null,debug:false,toggleElements:null,onShow:function(){},onClose:function(){},onSelect:function(){}},initialize:function(b,a){this.attachTo=b;this.setOptions(a).attach();if(this.options.timePickerOnly){this.options.timePicker=true;this.options.startView="time"}this.formatMinMaxDates();document.addEvent("mousedown",this.close.bind(this))},formatMinMaxDates:function(){if(this.options.minDate&&this.options.minDate.format){this.options.minDate=this.unformat(this.options.minDate.date,this.options.minDate.format)}if(this.options.maxDate&&this.options.maxDate.format){this.options.maxDate=this.unformat(this.options.maxDate.date,this.options.maxDate.format);this.options.maxDate.setHours(23);this.options.maxDate.setMinutes(59);this.options.maxDate.setSeconds(59)}},attach:function(){if($chk(this.options.toggleElements)){var a=$$(this.options.toggleElements);document.addEvents({keydown:function(b){if(b.key=="tab"){this.close(null,true)}}.bind(this)})}$$(this.attachTo).each(function(d,c){if(d.retrieve("datepicker")){return}if($chk(d.get("value"))){var b=this.format(new Date(this.unformat(d.get("value"),this.options.inputOutputFormat)),this.options.format)}else{if(!this.options.allowEmpty){var b=this.format(new Date(),this.options.format)}else{var b=""}}var e=d.getStyle("display");var f=d.setStyle("display",this.options.debug?e:"none").store("datepicker",true).clone().store("datepicker",true).removeProperty("name").removeProperty("pattern").setStyle("display",e).set("value",b).inject(d,"before");if($chk(this.options.toggleElements)){a[c].setStyle("cursor","pointer").addEvents({click:function(g){this.onFocus(d,f)}.bind(this)});f.addEvents({blur:function(){d.set("value",f.get("value"))}})}else{f.addEvents({keydown:function(g){if(this.options.allowEmpty&&(g.key=="delete"||g.key=="backspace")){d.set("value","");g.target.set("value","");this.close(null,true)}else{if(g.key=="tab"){this.close(null,true)}else{g.stop()}}}.bind(this),focus:function(g){this.onFocus(d,f)}.bind(this)})}}.bind(this))},onFocus:function(b,a){var c,e=a.getCoordinates();if($chk(b.get("value"))){c=this.unformat(b.get("value"),this.options.inputOutputFormat).valueOf()}else{c=new Date();if($chk(this.options.maxDate)&&c.valueOf()>this.options.maxDate.valueOf()){c=new Date(this.options.maxDate.valueOf())}if($chk(this.options.minDate)&&c.valueOf()<this.options.minDate.valueOf()){c=new Date(this.options.minDate.valueOf())}}this.show({left:e.left+this.options.positionOffset.x,top:e.top+e.height+this.options.positionOffset.y},c);this.input=b;this.visual=a;this.options.onShow()},dateToObject:function(a){return{year:a.getFullYear(),month:a.getMonth(),day:a.getDate(),hours:a.getHours(),minutes:a.getMinutes(),seconds:a.getSeconds()}},dateFromObject:function(a){var b=new Date();b.setDate(1);["year","month","day","hours","minutes","seconds"].each(function(d){var c=a[d];if(!$chk(c)){return}switch(d){case"day":b.setDate(c);break;case"month":b.setMonth(c);break;case"year":b.setFullYear(c);break;case"hours":b.setHours(c);break;case"minutes":b.setMinutes(c);break;case"seconds":b.setSeconds(c);break}});return b},show:function(a,b){this.formatMinMaxDates();if($chk(b)){this.d=new Date(b)}else{this.d=new Date()}this.today=new Date();this.choice=this.dateToObject(this.d);this.mode=(this.options.startView=="time"&&!this.options.timePicker)?"month":this.options.startView;this.render();this.picker.setStyles(a)},render:function(b){if(!$chk(this.picker)){this.constructPicker()}else{var c=this.oldContents;this.oldContents=this.newContents;this.newContents=c;this.newContents.empty()}var a=new Date(this.d.getTime());this.limit={right:false,left:false};if(this.mode=="decades"){this.renderDecades()}else{if(this.mode=="year"){this.renderYear()}else{if(this.mode=="time"){this.renderTime();this.limit={right:true,left:true}}else{this.renderMonth()}}}this.picker.getElement(".previous").setStyle("visibility",this.limit.left?"hidden":"visible");this.picker.getElement(".next").setStyle("visibility",this.limit.right?"hidden":"visible");this.picker.getElement(".titleText").setStyle("cursor",this.allowZoomOut()?"pointer":"default");this.d=a;if(this.picker.getStyle("opacity")==0){this.picker.tween("opacity",0,1)}if($chk(b)){this.fx(b)}},fx:function(a){if(a=="right"){this.oldContents.setStyles({left:0,opacity:1});this.newContents.setStyles({left:this.bodysize.x,opacity:1});this.slider.setStyle("left",0).tween("left",0,-this.bodysize.x)}else{if(a=="left"){this.oldContents.setStyles({left:this.bodysize.x,opacity:1});this.newContents.setStyles({left:0,opacity:1});this.slider.setStyle("left",-this.bodysize.x).tween("left",-this.bodysize.x,0)}else{if(a=="fade"){this.slider.setStyle("left",0);this.oldContents.setStyle("left",0).set("tween",{duration:this.options.animationDuration/2}).tween("opacity",1,0);this.newContents.setStyles({opacity:0,left:0}).set("tween",{duration:this.options.animationDuration}).tween("opacity",0,1)}}}},constructPicker:function(){this.picker=new Element("div",{"class":this.options.pickerClass}).setStyle("z-index",++window.maxZindex).inject(document.body);if(this.options.useFadeInOut){this.picker.setStyles({opacity:0}).set("tween",{duration:this.options.animationDuration})}var d=new Element("div",{"class":"header"}).inject(this.picker);var c=new Element("div",{"class":"title"}).inject(d);new Element("div",{"class":"previous"}).addEvent("click",this.previous.bind(this)).set("text","«").inject(d);new Element("div",{"class":"next"}).addEvent("click",this.next.bind(this)).set("text","»").inject(d);new Element("div",{"class":"closeButton"}).addEvent("click",this.close.bindWithEvent(this,true)).set("text","x").inject(d);new Element("span",{"class":"titleText"}).addEvent("click",this.zoomOut.bind(this)).inject(c);var a=new Element("div",{"class":"body"}).inject(this.picker);this.bodysize=a.getSize();this.slider=new Element("div",{styles:{position:"absolute",top:0,left:0,width:2*this.bodysize.x,height:this.bodysize.y}}).set("tween",{duration:this.options.animationDuration,transition:Fx.Transitions.Quad.easeInOut}).inject(a);this.oldContents=new Element("div",{styles:{position:"absolute",top:0,left:this.bodysize.x,width:this.bodysize.x,height:this.bodysize.y}}).inject(this.slider);this.newContents=new Element("div",{styles:{position:"absolute",top:0,left:0,width:this.bodysize.x,height:this.bodysize.y}}).inject(this.slider)},renderTime:function(){var a=new Element("div",{"class":"time"}).inject(this.newContents);if(this.options.timePickerOnly){this.picker.getElement(".titleText").set("text","Select a time")}else{this.picker.getElement(".titleText").set("text",this.format(this.d,"j M, Y"))}new Element("input",{type:"text","class":"hour"}).set("value",this.leadZero(this.d.getHours())).addEvents({mousewheel:function(d){var c=d.target,b=c.get("value").toInt();c.focus();if(d.wheel>0){b=(b<23)?b+1:0}else{b=(b>0)?b-1:23}c.set("value",this.leadZero(b));d.stop()}.bind(this)}).set("maxlength",2).inject(a);new Element("input",{type:"text","class":"minutes"}).set("value",this.leadZero(this.d.getMinutes())).addEvents({mousewheel:function(d){var c=d.target,b=c.get("value").toInt();c.focus();if(d.wheel>0){b=(b<59)?b+1:0}else{b=(b>0)?b-1:59}c.set("value",this.leadZero(b));d.stop()}.bind(this)}).set("maxlength",2).inject(a);new Element("div",{"class":"separator"}).set("text",":").inject(a);new Element("input",{type:"submit",value:"OK","class":"ok"}).addEvents({click:function(b){b.stop();this.select($merge(this.dateToObject(this.d),{hours:this.picker.getElement(".hour").get("value").toInt(),minutes:this.picker.getElement(".minutes").get("value").toInt()}))}.bind(this)}).set("maxlength",2).inject(a)},renderMonth:function(){var h=this.d.getMonth();this.picker.getElement(".titleText").set("text",this.options.months[h]+" "+this.d.getFullYear());this.d.setDate(1);while(this.d.getDay()!=this.options.startDay){this.d.setDate(this.d.getDate()-1)}var a=new Element("div",{"class":"days"}).inject(this.newContents);var g=new Element("div",{"class":"titles"}).inject(a);var k,f,c,j,m;for(k=this.options.startDay;k<(this.options.startDay+7);k++){new Element("div",{"class":"title day day"+(k%7)}).set("text",this.options.days[(k%7)].substring(0,this.options.dayShort)).inject(g)}var b=false;var n=this.today.toDateString();var l=this.dateFromObject(this.choice).toDateString();for(f=0;f<42;f++){c=[];c.push("day");c.push("day"+this.d.getDay());if(this.d.toDateString()==n){c.push("today")}if(this.d.toDateString()==l){c.push("selected")}if(this.d.getMonth()!=h){c.push("otherMonth")}if(f%7==0){m=new Element("div",{"class":"week week"+(Math.floor(f/7))}).inject(a)}j=new Element("div",{"class":c.join(" ")}).set("text",this.d.getDate()).inject(m);if(this.limited("date")){j.addClass("unavailable");if(b){this.limit.right=true}else{if(this.d.getMonth()==h){this.limit.left=true}}}else{b=true;j.addEvent("click",function(i,o){if(this.options.timePicker){this.d.setDate(o.day);this.d.setMonth(o.month);this.mode="time";this.render("fade")}else{this.select(o)}}.bindWithEvent(this,{day:this.d.getDate(),month:this.d.getMonth(),year:this.d.getFullYear()}))}this.d.setDate(this.d.getDate()+1)}if(!b){this.limit.right=true}},renderYear:function(){var g=this.today.getMonth();var c=this.d.getFullYear()==this.today.getFullYear();var h=this.d.getFullYear()==this.choice.year;this.picker.getElement(".titleText").set("text",this.d.getFullYear());this.d.setMonth(0);var b,f;var d=false;var a=new Element("div",{"class":"months"}).inject(this.newContents);for(b=0;b<=11;b++){f=new Element("div",{"class":"month month"+(b+1)+(b==g&&c?" today":"")+(b==this.choice.month&&h?" selected":"")}).set("text",this.options.monthShort?this.options.months[b].substring(0,this.options.monthShort):this.options.months[b]).inject(a);if(this.limited("month")){f.addClass("unavailable");if(d){this.limit.right=true}else{this.limit.left=true}}else{d=true;f.addEvent("click",function(i,j){this.d.setDate(1);this.d.setMonth(j);this.mode="month";this.render("fade")}.bindWithEvent(this,b))}this.d.setMonth(b)}if(!d){this.limit.right=true}},renderDecades:function(){while(this.d.getFullYear()%this.options.yearsPerPage>0){this.d.setFullYear(this.d.getFullYear()-1)}this.picker.getElement(".titleText").set("text",this.d.getFullYear()+"-"+(this.d.getFullYear()+this.options.yearsPerPage-1));var b,f,d;var c=false;var a=new Element("div",{"class":"years"}).inject(this.newContents);if($chk(this.options.minDate)&&this.d.getFullYear()<=this.options.minDate.getFullYear()){this.limit.left=true}for(b=0;b<this.options.yearsPerPage;b++){f=this.d.getFullYear();d=new Element("div",{"class":"year year"+b+(f==this.today.getFullYear()?" today":"")+(f==this.choice.year?" selected":"")}).set("text",f).inject(a);if(this.limited("year")){d.addClass("unavailable");if(c){this.limit.right=true}else{this.limit.left=true}}else{c=true;d.addEvent("click",function(g,h){this.d.setFullYear(h);this.mode="year";this.render("fade")}.bindWithEvent(this,f))}this.d.setFullYear(this.d.getFullYear()+1)}if(!c){this.limit.right=true}if($chk(this.options.maxDate)&&this.d.getFullYear()>=this.options.maxDate.getFullYear()){this.limit.right=true}},limited:function(c){var b=$chk(this.options.minDate);var d=$chk(this.options.maxDate);if(!b&&!d){return false}switch(c){case"year":return(b&&this.d.getFullYear()<this.options.minDate.getFullYear())||(d&&this.d.getFullYear()>this.options.maxDate.getFullYear());case"month":var a=(""+this.d.getFullYear()+this.leadZero(this.d.getMonth())).toInt();return b&&a<(""+this.options.minDate.getFullYear()+this.leadZero(this.options.minDate.getMonth())).toInt()||d&&a>(""+this.options.maxDate.getFullYear()+this.leadZero(this.options.maxDate.getMonth())).toInt();case"date":return(b&&this.d<this.options.minDate)||(d&&this.d>this.options.maxDate)}},allowZoomOut:function(){if(this.mode=="time"&&this.options.timePickerOnly){return false}if(this.mode=="decades"){return false}if(this.mode=="year"&&!this.options.yearPicker){return false}return true},zoomOut:function(){if(!this.allowZoomOut()){return}if(this.mode=="year"){this.mode="decades"}else{if(this.mode=="time"){this.mode="month"}else{this.mode="year"}}this.render("fade")},previous:function(){if(this.mode=="decades"){this.d.setFullYear(this.d.getFullYear()-this.options.yearsPerPage)}else{if(this.mode=="year"){this.d.setFullYear(this.d.getFullYear()-1)}else{if(this.mode=="month"){this.d.setMonth(this.d.getMonth()-1)}}}this.render("left")},next:function(){if(this.mode=="decades"){this.d.setFullYear(this.d.getFullYear()+this.options.yearsPerPage)}else{if(this.mode=="year"){this.d.setFullYear(this.d.getFullYear()+1)}else{if(this.mode=="month"){this.d.setMonth(this.d.getMonth()+1)}}}this.render("right")},close:function(c,b){if(!$(this.picker)){return}var a=($chk(c)&&c.target!=this.picker&&!this.picker.hasChild(c.target)&&c.target!=this.visual);if(b||a){if(this.options.useFadeInOut){this.picker.set("tween",{duration:this.options.animationDuration/2,onComplete:this.destroy.bind(this)}).tween("opacity",1,0)}else{this.destroy()}}},destroy:function(){this.picker.destroy();this.picker=null;this.options.onClose()},select:function(a){this.choice=$merge(this.choice,a);var b=this.dateFromObject(this.choice);this.input.set("value",this.format(b,this.options.inputOutputFormat));this.visual.set("value",this.format(b,this.options.format));this.options.onSelect(b);this.close(null,true)},leadZero:function(a){return a<10?"0"+a:a},format:function(c,g){var e="";var d=c.getHours();var a=c.getMonth();for(var b=0;b<g.length;b++){switch(g.charAt(b)){case"\\":b++;e+=g.charAt(b);break;case"y":e+=(100+c.getYear()+"").substring(1);break;case"Y":e+=c.getFullYear();break;case"m":e+=this.leadZero(a+1);break;case"n":e+=(a+1);break;case"M":e+=this.options.months[a].substring(0,this.options.monthShort);break;case"F":e+=this.options.months[a];break;case"d":e+=this.leadZero(c.getDate());break;case"j":e+=c.getDate();break;case"D":e+=this.options.days[c.getDay()].substring(0,this.options.dayShort);break;case"l":e+=this.options.days[c.getDay()];break;case"G":e+=d;break;case"H":e+=this.leadZero(d);break;case"g":e+=(d%12?d%12:12);break;case"h":e+=this.leadZero(d%12?d%12:12);break;case"a":e+=(d>11?"pm":"am");break;case"A":e+=(d>11?"PM":"AM");break;case"i":e+=this.leadZero(c.getMinutes());break;case"s":e+=this.leadZero(c.getSeconds());break;case"U":e+=Math.floor(c.valueOf()/1000);break;default:e+=g.charAt(b)}}return e},unformat:function(h,j){var k=new Date();var e={};var l,b;h=h.toString();for(var g=0;g<j.length;g++){l=j.charAt(g);switch(l){case"\\":r=null;g++;break;case"y":r="[0-9]{2}";break;case"Y":r="[0-9]{4}";break;case"m":r="0[1-9]|1[012]";break;case"n":r="[1-9]|1[012]";break;case"M":r="[A-Za-z]{"+this.options.monthShort+"}";break;case"F":r="[A-Za-z]+";break;case"d":r="0[1-9]|[12][0-9]|3[01]";break;case"j":r="[1-9]|[12][0-9]|3[01]";break;case"D":r="[A-Za-z]{"+this.options.dayShort+"}";break;case"l":r="[A-Za-z]+";break;case"G":case"H":case"g":case"h":r="[0-9]{1,2}";break;case"a":r="(am|pm)";break;case"A":r="(AM|PM)";break;case"i":case"s":r="[012345][0-9]";break;case"U":r="-?[0-9]+$";break;default:r=null}if($chk(r)){b=h.match("^"+r);if($chk(b)){e[l]=b[0];h=h.substring(e[l].length)}else{if(this.options.debug){alert("Fatal Error in DatePicker\n\nUnexpected format at: '"+h+"' expected format character '"+l+"' (pattern '"+r+"')")}return k}}else{h=h.substring(1)}}for(l in e){var f=e[l];switch(l){case"y":k.setFullYear(f<30?2000+f.toInt():1900+f.toInt());break;case"Y":k.setFullYear(f);break;case"m":case"n":k.setMonth(f-1);break;case"M":f=this.options.months.filter(function(c,a){return c.substring(0,this.options.monthShort)==f}.bind(this))[0];case"F":k.setMonth(this.options.months.indexOf(f));break;case"d":case"j":k.setDate(f);break;case"G":case"H":k.setHours(f);break;case"g":case"h":if(e.a=="pm"||e.A=="PM"){k.setHours(f==12?0:f.toInt()+12)}else{k.setHours(f)}break;case"i":k.setMinutes(f);break;case"s":k.setSeconds(f);break;case"U":k=new Date(f.toInt()*1000)}}return k}});function printCalendar(c,b,f,a){if(!f){f=["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"]}if(!a){a=["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"]}var d=new DatePicker(b,{pickerClass:"datepicker_jqui",days:f,months:a,format:"d/m/Y",inputOutputFormat:"d/m/Y",startDay:1,allowEmpty:true});b.getPrevious("input").fireEvent("focus")}var layerWindow=new Class({Implements:[Options,Chain],options:{id:null,bodyId:null,title:null,width:400,height:null,minWidth:300,minHeight:100,maxHeight:null,draggable:true,resize:true,closeButtonUrl:null,closeButtonLabel:null,destroyOnClose:true,overlay:true,url:"",html:" ",htmlNode:null,closeCallback:null,closeCallbackParam:null,disableObjects:false,reloadZindex:false},initialize:function(a){this.showing=false;if($defined(a)){this.setOptions(a)}this.checkOptions();if($chk(this.options.title)){this.title=this.options.title}if($chk(this.options.html)){this.html=this.options.html}if($chk(this.options.htmlNode)){this.htmlNode=$type(this.options.htmlNode)=="element"?this.options.htmlNode:$(this.options.htmlNode)}if($chk(this.options.url)){this.url=this.options.url}if(!$chk(this.options.maxHeight)){this.options.maxHeight=getViewport().height-100}if(this.options.reloadZindex){window.maxZindex=getMaxZindex()}},checkOptions:function(){var a=/[0-9]+/;if(!a.test(this.options.width)||this.options.width<this.options.minWidth){this.options.width=400}},setTitle:function(a){this.title=a;if(this.showing){this.header.set("html",a)}},setHtml:function(a){this.html=a;if(this.showing){this.body.set("html",a)}},setUrl:function(a){this.url=a;if(this.showing){this.request()}},display:function(b,a){this.delement=!b?null:$type(b)=="element"?b:$(b);this.dopt=a;if(this.options.disableObjects){this.dObjects()}this.showing=true;if(this.options.overlay){this.renderOverlay()}this.renderContainer();this.renderHeader();this.renderBody();this.renderFooter();this.container.setStyle("width",(this.body.getCoordinates().width)+"px");this.initBodyHeight=this.body.getStyle("height").toInt();this.initContainerDim=this.container.getCoordinates();if(this.options.draggable){this.makeDraggable()}if(this.options.resize){this.makeResizable()}},renderOverlay:function(){var a=document.getScrollSize();this.overlay=new Element("div",{"class":"abiWinOverlay"});this.overlay.setStyles({top:"0px",left:"0px",width:a.x,height:a.y,"z-index":++window.maxZindex});this.overlay.inject(document.body)},dObjects:function(){for(var a=0;a<window.frames.length;a++){var c=window.frames[a];if(sameDomain(c)){var d=c.document.getElementsByTagName("object");for(var b=0;b<d.length;b++){d[b].style.visibility="hidden"}}}$$("object").each(function(e){e.style.visibility="hidden"})},eObjects:function(){for(var a=0;a<window.frames.length;a++){var c=window.frames[a];if(sameDomain(c)){var d=c.document.getElementsByTagName("object");for(var b=0;b<d.length;b++){d[b].style.visibility="visible"}}}$$("object").each(function(e){e.style.visibility="visible"})},renderContainer:function(){this.container=new Element("div",{id:this.options.id,"class":"abiWin"});this.container.setStyles({visibility:"hidden"});this.setFocus();this.container.addEvent("mousedown",this.setFocus.bind(this));this.container.inject(document.body)},locateContainer:function(){var a=$chk(this.delement)?this.delement.getCoordinates():null;this.top=(this.dopt&&$chk(this.dopt.top))?this.dopt.top<0?0:this.dopt.top:a?a.top:(getViewport().cY-this.container.getCoordinates().height/2);this.left=(this.dopt&&$chk(this.dopt.left))?this.dopt.left<0?0:this.dopt.left:a?a.left:(getViewport().cX-this.container.getCoordinates().width/2);this.container.setStyles({top:this.top+"px",left:this.left+"px",visibility:"visible"})},renderHeader:function(){this.header=new Element("header",{"class":"abiHeader"});this.header.set("html",this.title);var a;if($chk(this.options.closeButtonUrl)&&$type(this.options.closeButtonUrl)=="string"){a=new Element("img",{src:this.options.closeButtonUrl,"class":"close"})}else{if($chk(this.options.closeButtonLabel)){a=new Element("span",{"class":"close"});a.set("html",this.options.closeButtonLabel)}else{a=new Element("span",{"class":"close_img"})}}a.addEvent("click",this.closeWindow.bind(this));this.header.inject(this.container,"top");a.inject(this.header,"before")},renderBody:function(){this.body=new Element("div",{id:this.options.bodyId,"class":"body"});this.body.setStyles({width:this.options.width,height:this.options.height,"max-height":this.options.maxHeight});this.body.inject(this.container,"bottom");$chk(this.url)?this.request():$chk(this.htmlNode)?this.body.set("html",this.htmlNode.clone(true,true).get("html")):this.body.set("html",this.html);if(!$chk(this.url)||this.options.height){this.locateContainer()}},renderFooter:function(){this.footer=new Element("footer");this.footer.inject(this.container,"bottom")},renderResizeCtrl:function(){this.resCtrl=new Element("div").setStyles({position:"absolute",right:"0",bottom:"0",width:"10px",height:"10px",cursor:"se-resize"});this.resCtrl.inject(this.footer,"top")},makeDraggable:function(){var a=document.getCoordinates();if(this.options.draggable){var b=new Drag(this.container,{handle:this.header,limit:{x:[0,(a.width-this.container.getCoordinates().width)],y:[0]}});this.header.setStyle("cursor","move")}},makeResizable:function(){this.renderResizeCtrl();var a=$chk(this.options.maxHeight)?this.options.maxHeight+this.header.getCoordinates().height+this.header.getStyle("margin-top").toInt()+this.header.getStyle("margin-bottom").toInt()+this.container.getStyle("padding-top").toInt()+this.container.getStyle("padding-bottom").toInt():document.body.getCoordinates().height-20;this.container.makeResizable({handle:this.resCtrl,limit:{x:[this.options.minWidth,(document.body.getCoordinates().width-20)],y:[this.options.minHeight,a]},onDrag:function(b){this.resizeBody()}.bind(this),onComplete:function(b){this.makeDraggable()}.bind(this)})},resizeBody:function(){this.body.setStyles({width:this.options.width.toInt()+(this.container.getCoordinates().width-this.initContainerDim.width),height:this.initBodyHeight+(this.container.getCoordinates().height-this.initContainerDim.height)})},request:function(){ajaxRequest("post",this.url,"",this.body,{script:true,load:this.body,callback:this.locateContainer.bind(this)})},setFocus:function(){if(!this.container.style.zIndex||(this.container.getStyle("z-index").toInt()<window.maxZindex)){this.container.setStyle("z-index",++window.maxZindex)}},closeWindow:function(){this.showing=false;if(this.options.disableObjects){this.chain(this.container.dispose(),this.eObjects())}else{this.container.dispose()}if(this.options.overlay){this.overlay.dispose()}if($chk(this.options.closeCallback)){this.options.closeCallback(this.options.closeCallbackParam)}if(this.options.destroyOnClose){for(var a in this){this[a]=null}}}});function getViewport(){var b,a,d,c,f,e;if(typeof window.innerWidth!="undefined"){b=window.innerWidth,a=window.innerHeight}else{if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!=0){b=document.documentElement.clientWidth,a=document.documentElement.clientHeight}}c=$chk(self.pageYOffset)?self.pageYOffset:(document.documentElement&&$chk(document.documentElement.scrollTop))?document.documentElement.scrollTop:document.body.clientHeight;d=$chk(self.pageXOffset)?self.pageXOffset:(document.documentElement&&$chk(document.documentElement.scrollTop))?document.documentElement.scrollLeft:document.body.clientWidth;f=d+b/2;e=c+a/2;return{width:b,height:a,left:d,top:c,cX:f,cY:e}}window.maxZindex=getMaxZindex();function getMaxZindex(){var a=0;$$("body *").each(function(b){if(b.getStyle("z-index").toInt()){a=Math.max(a,b.getStyle("z-index").toInt())}});return a}var hScrollingList=new Class({Implements:[Options],options:{id:null,list_height:null,tr_duration:1000},initialize:function(e,a,c,d,b){if($defined(b)){this.setOptions(b)}this.list=$type(e)=="element"?e:$(e);this.list.setStyle("visibility","hidden");this.listElements=this.list.getChildren("li");this.setWidths(c,d);this.vpItems=a;this.setSlide();this.setStyles();this.setWrapper();this.list.setStyle("visibility","visible");this.vps=1;this.tots=Math.ceil(this.listElements.length/this.vpItems);this.updateCtrl();this.tr=new Fx.Tween(this.slide,{duration:this.options.tr_duration,transition:"quad:out",onComplete:function(){this.busy=false}.bind(this)})},setWidths:function(b,a){this.width=b;this.ctrlWidth=24;this.cWidth=this.width-2*this.ctrlWidth;this.iWidth=a},setSlide:function(){var a=new Element("div",{styles:{clear:"both"}});this.slide=new Element("div",{styles:{position:"relative",width:"10000em"},"class":"slide"});this.slide.inject(this.list,"before");this.slide.grab(this.list);a.inject(this.slide,"bottom")},setWrapper:function(){this.wrapper=new Element("div",{styles:{width:this.width+"px"}});var b=this.listElements[0].getCoordinates().height;for(var a=1;a<this.listElements.length;a++){if(this.listElements[a].getCoordinates().height>b){b=this.listElements[a].getCoordinates().height}}this.leftCtrl=new Element("div",{styles:{"float":"left",width:this.ctrlWidth+"px",height:b+"px"}});this.rightCtrl=new Element("div",{styles:{"float":"right",width:this.ctrlWidth+"px",height:b+"px"}});this.itemContainer=new Element("div",{styles:{position:"relative",overflow:"hidden","float":"left",width:this.cWidth+"px"}});this.wrapper.adopt(this.leftCtrl,this.itemContainer,this.rightCtrl);this.wrapper.inject(this.slide,"before");this.itemContainer.adopt(this.slide)},setStyles:function(){this.list.setStyles({margin:"0",padding:"0","list-style-type":"none","list-style-position":"outside"});var a=this.vpItems*this.iWidth;while(a>this.cWidth){a=--this.vpItems*this.iWidth}var e=(this.cWidth-a)/2;for(var b=0;b<this.listElements.length;b++){var d=this.listElements[b];var c=b%this.vpItems;d.setStyles({"float":"left",width:this.iWidth+"px","margin-left":!b?e+"px":c?"0px":2*e+"px",height:this.options.list_height?this.options.list_height+"px":"auto"})}},scroll:function(a){if(this.busy){return false}this.busy=true;if(a=="right"){this.tr.start("left","-"+(this.cWidth*this.vps++)+"px")}else{if(a=="left"){this.tr.start("left","-"+(this.cWidth*(--this.vps-1))+"px")}}this.updateCtrl()},updateCtrl:function(){var a=this.vps==1?"leftCtrlOff":"leftCtrl";var b=this.vps==this.tots?"rightCtrlOff":"rightCtrl";this.leftCtrl.setProperty("class",a);this.rightCtrl.setProperty("class",b);if(this.vps==1){this.leftCtrl.removeEvents("mouseover");this.leftCtrl.removeEvents("mouseout");this.leftCtrl.removeEvents("click");this.le=false}else{if(!this.le){this.leftCtrl.addEvent("mouseover",function(){this.setProperty("class","leftCtrlOver")});this.leftCtrl.addEvent("mouseout",function(){this.setProperty("class","leftCtrl")});this.leftCtrl.addEvent("click",this.scroll.bind(this,"left"));this.le=true}}if(this.vps==this.tots){this.rightCtrl.removeEvents("mouseover");this.rightCtrl.removeEvents("mouseout");this.rightCtrl.removeEvents("click");this.re=false}else{if(!this.re){this.rightCtrl.addEvent("mouseover",function(){this.setProperty("class","rightCtrlOver")});this.rightCtrl.addEvent("mouseout",function(){this.setProperty("class","rightCtrl")});this.rightCtrl.addEvent("click",this.scroll.bind(this,"right"));this.re=true}}},deactivateCtrl:function(){this.leftCtrl.removeEvents("mouseover");this.leftCtrl.removeEvents("mouseout");this.leftCtrl.removeEvents("click");this.le=false;this.rightCtrl.removeEvents("mouseover");this.rightCtrl.removeEvents("mouseout");this.rightCtrl.removeEvents("click");this.re=false;this.leftCtrl.setProperty("class","leftCtrlOff");this.rightCtrl.setProperty("class","rightCtrlOff")}});var vScrollingList=new Class({Implements:[Options],options:{id:null,list_width:null,tr_duration:1000},initialize:function(d,a,c,e,b){if($defined(b)){this.setOptions(b)}this.list=$type(d)=="element"?d:$(d);this.listElements=this.list.getChildren("li");this.setHeights(c,e);this.vpItems=a;this.setSlide();this.setStyles();this.setWrapper();this.vps=1;this.tots=Math.ceil(this.listElements.length/this.vpItems);this.updateCtrl();this.tr=new Fx.Tween(this.slide,{duration:this.options.tr_duration,transition:"quad:out",onComplete:function(){this.busy=false}.bind(this)})},setHeights:function(b,a){this.height=b;this.ctrlHeight=24;this.cHeight=this.height-2*this.ctrlHeight;this.iHeight=a},setSlide:function(){var a=new Element("div",{styles:{clear:"both"}});this.slide=new Element("div",{styles:{position:"relative",height:"10000em","padding-top":"2px"},"class":"slide"});this.slide.inject(this.list,"before");this.slide.grab(this.list);a.inject(this.slide,"bottom")},setWrapper:function(){this.wrapper=new Element("div",{styles:{height:this.height+"px"}});this.topCtrl=new Element("div",{styles:{height:this.ctrlHeight+"px"}});this.bottomCtrl=new Element("div",{styles:{height:this.ctrlHeight+"px"}});this.itemContainer=new Element("div",{styles:{position:"relative",overflow:"hidden",height:this.cHeight+"px"}});this.wrapper.adopt(this.topCtrl,this.itemContainer,this.bottomCtrl);this.wrapper.inject(this.slide,"before");this.itemContainer.adopt(this.slide)},setStyles:function(){this.list.setStyles({margin:"0",padding:"0","list-style-type":"none","list-style-position":"outside"});var b=this.cHeight-4;var f=this.vpItems*(this.iHeight+1)+1;while(f>b){f=--this.vpItems*(this.iHeight+1)+1}var e=(this.cHeight-f)/2;for(var a=0;a<this.listElements.length;a++){var d=this.listElements[a];var c=a%this.vpItems;d.setStyles({"border-top":(c?0:1)+"px solid #000","border-bottom":"1px solid #000",height:this.iHeight+"px",padding:"0","float":"left",clear:"left",margin:"0","margin-top":!a?(e-2)+"px":c?"0px":2*e+"px",width:this.options.list_width?this.options.list_width+"px":"100%"})}},scroll:function(a){if(this.busy){return false}this.busy=true;if(a=="bottom"){this.tr.start("top","-"+(this.cHeight*this.vps++)+"px")}else{if(a=="top"){this.tr.start("top","-"+(this.cHeight*(--this.vps-1))+"px")}}this.updateCtrl()},updateCtrl:function(){var a=this.vps==1?"topCtrlOff":"topCtrl";var b=this.vps==this.tots?"bottomCtrlOff":"bottomCtrl";this.topCtrl.setProperty("class",a);this.bottomCtrl.setProperty("class",b);if(this.vps==1){this.topCtrl.removeEvents("mouseover");this.topCtrl.removeEvents("mouseout");this.topCtrl.removeEvents("click");this.te=false}else{if(!this.te){this.topCtrl.addEvent("mouseover",function(){this.setProperty("class","topCtrlOver")});this.topCtrl.addEvent("mouseout",function(){this.setProperty("class","topCtrl")});this.topCtrl.addEvent("click",this.scroll.bind(this,"top"));this.te=true}}if(this.vps==this.tots){this.bottomCtrl.removeEvents("mouseover");this.bottomCtrl.removeEvents("mouseout");this.bottomCtrl.removeEvents("click");this.be=false}else{if(!this.be){this.bottomCtrl.addEvent("mouseover",function(){this.setProperty("class","bottomCtrlOver")});this.bottomCtrl.addEvent("mouseout",function(){this.setProperty("class","bottomCtrl")});this.bottomCtrl.addEvent("click",this.scroll.bind(this,"bottom"));this.be=true}}},deactivateCtrl:function(){this.topCtrl.removeEvents("mouseover");this.topCtrl.removeEvents("mouseout");this.topCtrl.removeEvents("click");this.te=false;this.bottomCtrl.removeEvents("mouseover");this.bottomCtrl.removeEvents("mouseout");this.bottomCtrl.removeEvents("click");this.be=false;this.topCtrl.setProperty("class","topCtrlOff");this.bottomCtrl.setProperty("class","bottomCtrlOff")}});